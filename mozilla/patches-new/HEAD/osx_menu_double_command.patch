Index: widget/src/cocoa/nsChildView.mm
===================================================================
RCS file: widget/src/cocoa/nsChildView.mm,v
retrieving revision 1.362
diff -u -r1.362 nsChildView.mm
--- widget/src/cocoa/nsChildView.mm	22 Jul 2008 15:19:11 -0000	1.362
+++ widget/src/cocoa/nsChildView.mm	20 Aug 2008 20:51:35 -0000
@@ -5407,6 +5410,12 @@
   // If this is a plugin, we do actually perform the action on keyboard commands. See bug 428047.
   // If the action on plugins here changes the first responder, don't continue.
   NSMenu* mainMenu = [NSApp mainMenu];
+#if 1
+   /* ACTIVESTATE, reverting patch from bug 428047 (see above) to prevent
+      double execution of menu related key events */
+  if ([mainMenu isKindOfClass:[GeckoNSMenu class]])
+    [(GeckoNSMenu*)mainMenu performMenuUserInterfaceEffectsForEvent:theEvent];
+#else
   if (mIsPluginView) {
     if ([mainMenu isKindOfClass:[GeckoNSMenu class]])
       [(GeckoNSMenu*)mainMenu actOnKeyEquivalent:theEvent];
@@ -5419,7 +5428,7 @@
     if ([mainMenu isKindOfClass:[GeckoNSMenu class]])
       [(GeckoNSMenu*)mainMenu performMenuUserInterfaceEffectsForEvent:theEvent];
   }
-
+#endif
   // With Cmd key or Ctrl+Tab or Ctrl+Esc, keyDown will be never called.
   // Therefore, we need to call processKeyDownEvent from performKeyEquivalent.
   UInt32 modifierFlags = [theEvent modifierFlags] & NSDeviceIndependentModifierFlagsMask;
